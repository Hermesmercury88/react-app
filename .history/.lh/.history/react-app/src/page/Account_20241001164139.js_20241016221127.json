{
    "sourceFile": ".history/react-app/src/page/Account_20241001164139.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1729091488933,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1729091488933,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from 'react';\r\nimport { useAuth } from '../AuthProvider';\r\nimport axios from 'axios';\r\nconst path = require('path');\r\n\r\nfunction Account() {\r\n    const { user } = useAuth();\r\n    const [account, setAccount] = useState([]);\r\n    const [showModal, setShowModal] = useState(false);\r\n    const [editedName, setEditedName] = useState('');\r\n    const [editedEmail, setEditedEmail] = useState('');\r\n    const [editedPicture, setEditedPicture] = useState(null);\r\n\r\n    const getAccount = () => {\r\n        axios.get(\"http://localhost:3000/account\", {\r\n            headers: {\r\n                Authorization: `Bearer ${user.token}`\r\n            }\r\n        }).then(res => {\r\n            setAccount(res.data);\r\n            setEditedName(res.data[0]?.name || '');\r\n            setEditedEmail(res.data[0]?.email || '');\r\n        }).catch(err => {\r\n            console.log(err);\r\n        });\r\n    };\r\n\r\n    useEffect(() => {\r\n        getAccount();\r\n    }, [user.token]);\r\n\r\n    const name = account[0]?.name;\r\n    const email = account[0]?.email;\r\n    const picture = account[0]?.picture;\r\n\r\n    const handleSave = () => {\r\n        const formData = new FormData();\r\n        formData.append(\"name\", editedName);\r\n        formData.append(\"email\", editedEmail);\r\n        if (editedPicture) {\r\n            formData.append(\"picture\", editedPicture); // อัปโหลดรูป\r\n        }\r\n        axios.put(\"http://localhost:3000/update-account\", formData, {\r\n            headers: {\r\n                Authorization: `Bearer ${user.token}`,\r\n                \"Content-Type\": \"multipart/form-data\"\r\n            }\r\n        }).then(() => {\r\n            getAccount();\r\n            setShowModal(false);\r\n        }).catch(err => {\r\n            console.log(err);\r\n        });\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <h1>Account</h1>\r\n            <div className='p-10 bg-red-100 text-black'>\r\n                <h1>Name: {name}</h1>\r\n                <h1>Email: {email}</h1>\r\n                <h1>Profile:</h1>\r\n                {picture ? (\r\n                    <img \r\n                        src={picture}\r\n                        alt=\"Profile\"\r\n                        className=\"w-full h-full rounded-full object-cover\"\r\n                    />\r\n                ) : (\r\n                    <div className=\"w-full h-full flex items-center justify-center bg-gray-200 rounded-full\">\r\n                        <span className=\"text-gray-500\">N/A</span>\r\n                    </div>\r\n                )}\r\n            </div>\r\n            <div className=\"my-3 flex justify-center\">\r\n                <button onClick={() => setShowModal(true)} className=\"p-2 bg-red-500 rounded hover:bg-blue-400\">\r\n                    แก้ไขข้อมูล\r\n                </button>\r\n            </div>\r\n\r\n            {showModal && (\r\n                <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50\">\r\n                    <div className=\"bg-white p-6 rounded-lg shadow-lg w-full max-w-md\">\r\n                        <h2 className=\"text-lg font-bold mb-4\">แก้ไขโปรไฟล์</h2>\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"block text-gray-700\">ชื่อ</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={editedName}\r\n                                onChange={(e) => setEditedName(e.target.value)}\r\n                                className=\"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"block text-gray-700\">อีเมล</label>\r\n                            <input\r\n                                type=\"email\"\r\n                                value={editedEmail}\r\n                                onChange={(e) => setEditedEmail(e.target.value)}\r\n                                className=\"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"mb-4\">\r\n                            <label className=\"block text-gray-700\">รูปโปรไฟล์</label>\r\n                            <input\r\n                                type=\"file\"\r\n                                onChange={(e) => setEditedPicture(e.target.files[0])}\r\n                                className=\"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"flex justify-end\">\r\n                            <button \r\n                            onClick={() => setShowModal(false)} className=\"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-400\">\r\n                                ยกเลิก\r\n                            </button>\r\n                            <button \r\n                            onClick={handleSave} className=\"ml-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-400\">\r\n                                บันทึก\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default Account;\r\n"
        }
    ]
}