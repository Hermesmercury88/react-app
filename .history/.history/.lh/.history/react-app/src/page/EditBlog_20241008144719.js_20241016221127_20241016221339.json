{
    "sourceFile": ".history/react-app/src/page/EditBlog_20241008144719.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1729090226690,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1729090226690,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\n\r\nfunction EditBlog() {\r\n    const { id } = useParams(); // ดึง id จาก URL parameter\r\n    const navigate = useNavigate(); // ใช้ useNavigate เพื่อเปลี่ยนเส้นทาง\r\n    const [title, setTitle] = useState('');\r\n    const [detail, setDetail] = useState('');\r\n    const [category, setCategory] = useState('');\r\n    const [loading, setLoading] = useState(true); // state สำหรับสถานะการดึงข้อมูล\r\n\r\n\r\n    const listCategory = [\r\n        { id: 1, cateName: \"ความรู้\" },\r\n        { id: 2, cateName: \"บันเทิง\" },\r\n    ];\r\n    // ฟังก์ชันดึงข้อมูลบล็อกตาม id\r\n    const getBlogById = async () => {\r\n        try {\r\n            const response = await axios.get(`http://localhost:4000/post/${id}`);\r\n            const { title, detail, category } = response.data;\r\n            setTitle(title);\r\n            setDetail(detail);\r\n            setCategory(category);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error(\"Error fetching blog data: \", error);\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // ดึงข้อมูลบล็อกเมื่อโหลดหน้า Component\r\n    useEffect(() => {\r\n        getBlogById();\r\n    }, []);\r\n\r\n    // ฟังก์ชันสำหรับการบันทึกการแก้ไขบล็อก\r\n    const handleSave = async (e) => {\r\n        e.preventDefault(); // ป้องกันการรีเฟรชหน้า\r\n\r\n        try {\r\n            await axios.put(`http://localhost:4000/post/${id}`, {\r\n                title,\r\n                detail,\r\n                category,\r\n            });\r\n            alert(\"บันทึกการแก้ไขเรียบร้อย\");\r\n            navigate('/myblog');\r\n        } catch (error) {\r\n            console.error(\"Error updating blog: \", error);\r\n            alert(\"เกิดข้อผิดพลาดในการบันทึกข้อมูล\");\r\n        }\r\n    };\r\n\r\n    if (loading) return <div>กำลังโหลดข้อมูล...</div>;\r\n\r\n    return (\r\n        <div className=\"max-w-xl mx-auto p-4\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">แก้ไขโพสต์</h2>\r\n            <form onSubmit={handleSave}>\r\n                <div className=\"mb-4\">\r\n                    <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"title\">\r\n                        ชื่อเรื่อง\r\n                    </label>\r\n                    <input\r\n                        type=\"text\"\r\n                        id=\"title\"\r\n                        value={title}\r\n                        onChange={(e) => setTitle(e.target.value)}\r\n                        className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\r\n                        required\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"mb-4\">\r\n                    <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"category\">\r\n                        หมวดหมู่\r\n                    </label>\r\n                    <select\r\n                        id=\"category\"\r\n                        value={category}\r\n                        onChange={(e) => setCategory(e.target.value)} // อัปเดตค่าของ category เมื่อเลือก option ใหม่\r\n                        className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\r\n                    >\r\n                        {/* สร้าง option จาก listCategory */}\r\n                        {listCategory.map((cate) => (\r\n                            <option key={cate.id} value={cate.cateName}>\r\n                                {cate.cateName}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n\r\n                <div className=\"mb-4\">\r\n                    <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"detail\">\r\n                        รายละเอียด\r\n                    </label>\r\n                    <textarea\r\n                        id=\"detail\"\r\n                        value={detail}\r\n                        onChange={(e) => setDetail(e.target.value)}\r\n                        className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\r\n                        rows=\"5\"\r\n                        required\r\n                    />\r\n                </div>\r\n                <div className=\"flex items-center justify-between\">\r\n                    <button\r\n                        type=\"submit\"\r\n                        className=\"bg-blue-500 hover:bg-blue-400 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\"\r\n                    >\r\n                        บันทึก\r\n                    </button>\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => navigate(-1)} // กลับไปหน้าก่อนหน้า\r\n                        className=\"bg-gray-500 hover:bg-gray-400 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\"\r\n                    >\r\n                        ยกเลิก\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default EditBlog;"
        }
    ]
}